// ==UserScript==
// @run-at       document-start
// @name         NightMode for VK
// @version      1.6.0
// @description  Adds a nice, black-whity night mode for vk.
// @author       https://vk.com/id71110013
// @homepage     https://github.com/NIK220V/vk-darkmode-css
// @updateURL    https://github.com/NIK220V/vk-darkmode-css/raw/master/vk_darkmode_css.meta.js
// @downloadURL  https://github.com/NIK220V/vk-darkmode-css/raw/master/vk_darkmode_css.user.js
// @match        *://*.vk.com/*
// @grant        GM_getValue
// @grant        GM_setValue
// ==/UserScript==

if (GM_getValue("VKNOptions") == null) GM_setValue("VKNOptions", {'noonline': false, 'silentwrite': false, 'silentread': false, 'silentwatch': false, 'nodeleteall': false});

var vknopts = GM_getValue("VKNOptions");

String.prototype.replaceAll = function(search, replacement) {
    var target = this;
    return target.replace(new RegExp(search, 'g'), replacement);
};

// Темы. Можете добавлять свои и использовать их.
var themes = {
    'night': {
        very_gray: 'rgba(17, 17, 17, 1)',
        slightly_gray: 'rgba(35, 35, 35, 1)',
        slightly_gray_1: 'rgba(36, 36, 36, 1)',
        slightly_gray_hovered: 'rgba(71, 71, 71, 1)',
        slighterer_gray_hovered: '#5d5c5c',
        okay_gray: 'rgba(136, 136, 136, 1)',
        unread_message: 'rgba(55, 55, 55, 1)',
        read_text: 'rgba(175, 175, 175, 1)',
        linked_gray: '#828282',
        linked_gray_light: '#999999',
        pure_white: 'white',
        grayscale: 'grayscale()'
    },
    'tinted': {
        very_gray: 'rgb(17,20,25)',
        slightly_gray: 'rgb(25, 28, 33)',
        slightly_gray_1: 'rgba(36, 36, 36, 1)',
        slightly_gray_hovered: 'rgb(37, 40, 47)',
        slighterer_gray_hovered: 'rgb(64, 71, 82)',
        okay_gray: 'rgb(113, 119, 128)',
        unread_message: 'rgb(37, 40, 47)',
        read_text: 'rgb(171, 202, 208)',
        linked_gray: 'rgb(101, 189, 243)',
        linked_gray_light: 'rgb(103, 109, 106)',
        pure_white: 'white',
        grayscale: '/',
        bell_sepia: 'sepia(0.619)'
    }
};
var theme = 'night';

var interval = -1, socalled = 'vkdarkmode';

var css = document.createElement('style');
css.id = socalled;
css.innerText = `
/* == TEXT COLORS == */
body, h1, h2, h3, .module_header .header_top, .profile_info_header_wrap a, .left_count_wrap, .button_gray button, .flat_button.secondary, input.text.ts_input:focus, .page_counter .count, .ui_tab_sel, .ui_tabs .ui_tab_sel, .ui_tabs_box .ui_tab_sel, .wall_module .post_like:hover, .wall_module .post_reply:hover, .wall_module .post_share:hover, .button_blue button.hover, .button_blue button:hover, .flat_button.hover, .flat_button:hover, .fakeinput, .fakeinput~.placeholder .ph_input, div[contenteditable=true], div[contenteditable=true]~.placeholder .ph_input, input.big_text, input.big_text~.placeholder .ph_input, input.dark, input.dark~.placeholder .ph_input, input.search, input.search~.placeholder .ph_input, input.text, input.text~.placeholder .ph_input, textarea, textarea~.placeholder .ph_input, .ui_actions_menu_item, a.groups_messages_block, .page_actions_dd_label, .page_actions_header_inner, .page_actions_item, .page_actions_cont.narrow .page_actions_header_inner, .pv_like, .pv_like_count, .page_doc_row .page_doc_title, .wall_tt, ul.listing li span, .wk_sub_sub_header, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_hovered .nim-dialog--preview, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_hovered .nim-dialog--text-preview, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_unread.nim-dialog_classic .nim-dialog--preview, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_unread.nim-dialog_classic .nim-dialog--text-preview, .nim-dialog:not(.nim-dialog_deleted):hover .nim-dialog--preview, .nim-dialog:not(.nim-dialog_deleted):hover .nim-dialog--text-preview, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_hovered .nim-dialog--preview>b, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_unread.nim-dialog_classic .nim-dialog--preview>b, .nim-dialog:not(.nim-dialog_deleted):hover .nim-dialog--preview>b, .nim-dialog .nim-dialog--name .nim-dialog--name-w, .ui_rmenu_item, .ui_rmenu_subitem, .im-page .nim-conversation-search-row .nim-dialog--name .nim-dialog--name-w, .im-page .im-search-results-head, .im-popular--name, .im-page--title-main-inner, .nim-dialog.nim-dialog_classic.nim-dialog_unread-out .nim-dialog--inner-text, .nim-dialog.nim-dialog_classic.nim-dialog_unread-out.nim-dialog_muted .nim-dialog--inner-text, .nim-dialog.nim-dialog_typing .nim-dialog--typing, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_hovered .nim-dialog--preview.nim-dialog--preview-attach, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_unread.nim-dialog_classic .nim-dialog--preview.nim-dialog--preview-attach, .nim-dialog:not(.nim-dialog_deleted):hover .nim-dialog--preview.nim-dialog--preview-attach, .nim-dialog .nim-dialog--preview-attach, .im-to-end, .top_notify_header, .replies_open, .wr_header, .ui_tabs_box .ui_tab_sel .ui_tab_count, .box_title_wrap.box_grey .box_title, .page_block_header, .web_cam_photo_icon, .ui_ownblock_label, .page_media_poll_title, .wl_replies_header, .mv_title, #mv_comments_header, .subheader, h4.subheader, .result_list ul li.active, .result_list ul li, .im-page-pinned--media, .tt_w, .wddi_text, .ts_contact_name, .im-fwd .im-fwd--title, .feed_new_posts, .im-chat-input--editing-head, .ui_multiselect_cnt .token .token_title, .ui_search_filters_pane .token .token_title, .page_block_sub_header, .wk_header, a b, b a, .audio_pl_edit_box .ape_audio_item_wrap .ape_attach, .audio_page_player .audio_page_player_title, ._audio_section__search .audio_row.audio_has_lyrics .audio_row__title_inner, .ap_layer__content .audio_row.audio_has_lyrics .audio_row__title_inner, .audio_page__audio_rows .audio_row.audio_has_lyrics .audio_row__title_inner, .audio_section_global_search__audios_block .audio_row.audio_has_lyrics .audio_row__title_inner, .audio_row__more_actions .audio_row__more_action, .audio_page__shuffle_all .audio_page__shuffle_all_button, .post_from_tt_row, .tickets_header, .tickets_reply_text, .top_audio_player .top_audio_player_title, .tu_row_comment, .selector_container td.selector input.focused, .selector_container td.selector input.selected, .im-page .im-page--mess-search, .ui_tab_group_items, .prefix_input_prefix, .prefix_input, .group_ad_amount, .pg_lnk_sel .pg_in, .group_ad_header, .mail_box_group_first_message, div.fc_editable~.placeholder .ph_content, .ui_search_new input.ui_search_field::placeholder, .wddi_over .wddi_sub, .ads_edit_value_header, .ads_edit_link_type_card_title, .apps_options_bar .apps_options_bar_left .app_summary_name, .app_actions_menu_wrap, .page_media_poll .page_poll_row_count, .im_stickerpack_name, .owner_photo_additional, .im-mess-stack .im-mess-stack--gift, .im-mess.im-mess_gift .im-mess--text, .pv_cont .pv_comments_header, .settings_label, #mv_pl_tt .mv_tt_playlist, .mv_recom_block_title, .idd_popup .idd_item, .idd_popup .idd_header, .reply_submit_hint_title, .reply_submit_hint_opts .radiobtn, .nim-dialog.nim-dialog_typing .nim-dialog--typer-el, .post_upload_dropbox, .mv_comments_summary, #dev_page_wrap1, .dev_page_block, .dev_page_cont .wk_header, .dev_page_cont .wk_sub_header, .dev_page_cont .wk_sub_sub_header, .dev_methods_list_desc, .group_online_answer_status_title, .group_online_status_title, .post_author_data .post_author_data_title, .photos_edit_selection_header, .dropbox_area, .feedback_header, .feedback_header b, .post_author span.author, .wall_module .copy_anon_author, .audio_claim_popup .audio_claim_popup__title, .shorten_list_stats_value, .dev_section_methods_wrap .dev_section_search_result_item, .exchange_subtab1, .exchange_table th, .tt_w.tickets_side_tt.text .tt_text, .tickets_tt_list, .tickets_tt_list_abuse, .tt_w.tickets_side_tt.title .tt_text, .help_table_question_visible>.help_table_question__q, .dev_result_num, .dev_result_bracket, .flist_item_name, .privacy_dropdown .header, .app_edit_block_header, .Tabs__item--active>*, .Button--tertiary, .Dropdown__in, .graph_menu_item.graph_menu_item_sel, .graph_menu_item.graph_menu_item_sel:hover, .gtop_complex_message .gtop_content .gtop_header, .article, .im-group-online-box .im-group-online-box--top, .Entity__title, .MultiSelect__token, .ChatSettingsMembersWidget__more, .docs_choose_dropbox, .wk_posts_stats_info_row .title, .wl_postreach_stat_subheader, .wk_reach_tooltip .wk_reach_tooltip_text, #stat_group_postsreach_table .table_header_upper_span, #stat_group_postsreach_table td, .market_item_title, .market_item_price, .market_comments_summary, .media_voting_question, .wl_postreach_stat_smalltext, .media_voting_option_text, .media_voting_option_percent, .media_voting_footer, .page_photo.page_action_menu_groups .page_actions_item.group_send_msg_status_block .group_send_msg_status_block_title, .microdata_price, #group_apps_list .group_apps_list_rows .group_apps_list_row .group_apps_list_row_info .group_apps_list_row_info_field.group_apps_list_row_info_app_name, .ui_tab_default .ui_tab_plain, .apps_edit_cont_row.active>.apps_edit_cont_name_c, .apps_edit_cont_row.active>.apps_edit_cont_name_c>input, .apps_edit_cont_name_c, input.apps_edit_cont_name, .cal_table .daysofweek, .im_cal_clear_lnk, .article_snippet.article_snippet_mini .article_snippet_mini_title, .app_widget_tiles_tile, .button_action_light, .button_action_light:hover, .im-replied--text, .right_list_header, .deep_active .post_replies_count, .deep_active.wall_module .post_replies_count, .links-list__title, .bt_comment_form_unavailable, .bt_tag_label, .bt_report_cmt_meta_content, .bugtracker_device, .bt_report_footer .reproducing .common_count, #apps_layer .apps_header .apps_name, .wk_hider_title, .author_page_article_title, .pages_history_header, .eltt .eltt_fancy_action, .groups_edit_event_log_page .groups_edit_event_log_items_wrap .groups_edit_event_log_item_wrap:hover>.groups_edit_event_log_item_main .groups_edit_event_log_item_date, .groups_edit_event_log_page .groups_edit_event_log_items_wrap .groups_edit_event_log_item_wrap_focused .groups_edit_event_log_item_date, .box_title_wrap.box_white .box_title, .mv_is_in_progress, .audio_pl_snippet2 .audio_shuffle_all_button, .audio_pl_snippet2 .audio_pl_snippet__action_btn, .im_stickers_my_tip, body.dev .paginated_table_header .paginated_table_cell *, .BugreportComment__metaContent, .Button--secondary, .audio_page_player2 .audio_page_player_title_song, .PeerProfile__content, .Select__option, .groups_edit_chats .groups_chats_promo .apps_group_catalog_promo_header, .ChatCreation__title, .ChatSettingsPresetPanel, .StickerPackPreview__description, .RightMenuBlock, .groups_edit_chats .groups_edit_chats_list__item.groups_edit_chats_list__item--setting .groups_edit_chats_list__item__text .groups_edit_chats_list__item__text__inner .groups_edit_chats_list__item__text__inner__content, .MiniAppsSnippetBottomFields__title, .BotCarousel__slideTitle, .audio_pl_edit_box .ape_add_audios_btn, .audio_pl_edit_box .ape_add_pl_audios_btn, .groups_cover_box .groups_edit_cover_header .groups_edit_cover_header_title, .groups_cover_box .groups_edit_cover_wrap .groups_edit_cover_wrap_desc, .FlatButton--secondary, .mention_tt_row, .narrow_column .group_chats .module_body .group_chat_label .group_chat_label_count, .BaseModal__content, .cal_table, .DonutLinkSnippet__title, .wall_reasons_list, .ui_gallery_wall_cards .wall_card__title_link, .box_title, .FCPanel__add, .ConvoTitle, .ConvoMessage, [dir] .FlatButton__content, .im-top-banner--text, .SettingsListItem__title, .im-right-menu .im-right-menu--counter[data-tab=mr], .im-right-menu .im-right-menu--counter[data-tab=business_notify], .im-right-menu .im-right-menu--counter[data-tab=archive], .im_stickers_my_name, .im_sticker_bl_name, .WeekStatGrid__ItemCount {color: %pure_white%;}
#side_bar ol li .left_row, input.ui_search_field, .exchange_table_hint, body.new_header_design #side_bar .left_label, [dir] .im_msg_media_wall .post_top_info_caption, .post_author, #pv_date_info, .VideoLayerInfo__views, .VerticalVideoLayerInfo__views, .VideoLayerInfo__date, .VerticalVideoLayerInfo__date, .audio_pl_item2 .audio_pl__subtitle, .feedback_footer {color: %okay_gray%;}
a, .nim-dialog .nim-dialog--preview, .nim-dialog .nim-dialog--text-preview, .im-fwd.im-fwd_msg .im-fwd--messages, .topics_module .topic_inner_link, .replies_short_text_deep, .wall_module .reply.reply_deleted .reply_text, .groups_edit_event_log_page .groups_edit_event_log_controls, .ts_wrap .input_back_content, .im-mess-stack .im-mess-stack--content .im-mess-stack--pname>a, [dir] .video_add_external {color: %read_text%;}
.page_counter:hover .label, #stl_text, .im-page-pinned--date, .PopupHeader__backBtn {color: %slighterer_gray_hovered%;}
.post_like, .post_reply, .post_share, .wall_copy_more, .wall_post_more, .wall_reply_more, .wall_post_text a, .im-page .im-page--clear-recent, .im-page-btn, .im-page-pinned--name, .post_video_title, .top_notify_cont, .top_notify_cont .feedback_header, a.wall_reply_greeting, .photos_choose_upload_area_drop_label, #stats_cont h4, .stats_head, .Button--link, .TopSearch .input_back_content, .RightMenuBlockInfo__mute, .page_list_module .group_desc, .page_list_module .people_desc, .page_list_module .people_extra, .profile_info .label, .page_counter .label, .im-page--title-meta, .post_date, .post_date .post_link, .post_date .wall_text_name_explain_promoted_post, .ui_crumb_count, .group_row_info, .mention_tt_online, .Entity__description, .group_edit_label, .ChatSettingsMembersEdit__role, .Tabs__desc, .ChatSettingsInfo__meta {color: %linked_gray%;}
.im-right-menu .im-right-menu--count, .photos_album_intro .photos_album_intro_desc, .ui_rmenu_count.ui_rmenu_count_grey, .ui_ownblock_hint, .wide_column .topics_module .topic_title, .olist_item_name, .wall_module .media_desc .a, .tickets_author, .nim-dialog .nim-dialog--date, .tu_mem, .header_side_link, .header_side_link a, .group_edit_labeled .idd_wrap .idd_selected_value, .summary_tab3, .page_block_info, .blst_mem, .ui_tab, .ui_tabs .ui_tab, .im-dropbox--msg, .im-fwd .im-fwd--date, .im-mess-stack .im-mess-stack--content .im-mess-stack--tools, .story_feed_new_item .stories_feed_item_name, .fc_contact_name, .ap_layer .audio_pl_snippet .audio_pl_snippet__header_inner, #ads_edit_audience_title, #ads_edit_recommended_cost_title, .page_media_poll .page_poll_row_percent, .privacy_dropdown .item, .privacy_dropdown .item_sel, .privacy_dropdown .item_sel_plus, .docs_choose_attach, .idd_wrap .idd_selected_value, .im-chat-input .im-chat-input--text *, .medadd_c_linkhead, .audio-msg-track.audio-msg-player .audio-msg-track--duration, .im-mess .im-mess--btn, .photos_container_edit_grid .photos_photo_edit_row_desc_placeholder.photos_edit_has_desc, .listing, .audio_pl_snippet .audio_pl_snippet__stats, .dark_box_label, .dev_result_key, .dev_const_param_name, .app_widget_list_row, .flist_summary, .apps_edit_retina_info, .apps_edit_nav_label, .wcomments_head, .Link, .graph_menu_item, .gtop_complex_message .gtop_content .gtop_message, .im-fwd .im-fwd--messages, .im-group-online-box .im-group-online-box--list .im-group-online-box--item .im-group-online-box--item-desc, .im-group-online-box .im-group-online-box--description .im-group-online-box--description-text .im-group-online-box--description-desc, .settings_activity_history .settings_history_main_info, .box_msg, .box_msg_gray, .ChatSettingsMembersWidget__add, .Tabs__item>*, .Select__control, .app_widget_table_td, .app_widget_table_th, .apps_edit_rows_review, .im-replied--author-link, .links-list__domain, .wk_gray, ul.listing li span .wk_gray, .deep_active .post_replies_header .post_replies_reorder, .mail_link__title, #group_section_menu .module_body .ui_gallery .ui_gallery_item .groups_menu_item .groups_menu_item_title, .im-page .im-page--center-empty, .post_action_btn.on, .im-page--title-reconnect, .im-mess--lbl-was-edited, .BotCarousel__slideDescription, [dir] .im-page .im-page--history-new-bar>span, [dir] .im-page .im-page--history-new-bar_days>span, .im-mess.im-mess_srv .im-mess--text, .PostBottomAction__count, .PostBottomAction__label, .im-page .im-page--top-date-bar, .box_title .back, .Settings__button, .SettingsListItem__description, .trending_stats_title_group__title, .landing_group_week_stat .trending_stats_int_item__title, .landing_author_guide_content {color: %linked_gray_light%;}
/* == BACKGROUND COLORS == */
body, input.text.ts_input, input.text.ts_input:focus, .im-page--chat-header, .im-page .im-page--top-date-bar, .nim-dialog.nim-dialog_failed .nim-dialog--unread, .nim-dialog.nim-dialog_unread .nim-dialog--unread, .nim-dialog.nim-dialog_unread.nim-dialog_prep-injected .nim-dialog--unread, .nim-dialog.nim-dialog_classic.nim-dialog_unread-out .nim-dialog--inner-text, .nim-dialog.nim-dialog_classic.nim-dialog_unread-out.nim-dialog_muted .nim-dialog--inner-text, .nim-dialog.nim-dialog_classic:not(.nim-dialog_deleted).nim-dialog_hovered.nim-dialog_unread-out .nim-dialog--inner-text, .nim-dialog.nim-dialog_classic:not(.nim-dialog_deleted).nim-dialog_hovered.nim-dialog_unread-out.nim-dialog_muted .nim-dialog--inner-text, .nim-dialog.nim-dialog_classic:not(.nim-dialog_deleted).nim-dialog_unread.nim-dialog_classic.nim-dialog_unread-out .nim-dialog--inner-text, .nim-dialog.nim-dialog_classic:not(.nim-dialog_deleted).nim-dialog_unread.nim-dialog_classic.nim-dialog_unread-out.nim-dialog_muted .nim-dialog--inner-text, .nim-dialog.nim-dialog_classic:not(.nim-dialog_deleted):hover.nim-dialog_unread-out .nim-dialog--inner-text, .nim-dialog.nim-dialog_classic:not(.nim-dialog_deleted):hover.nim-dialog_unread-out.nim-dialog_muted .nim-dialog--inner-text, .nim-dialog.nim-dialog_failed.nim-dialog_muted .nim-dialog--unread, .nim-dialog.nim-dialog_unread.nim-dialog_muted .nim-dialog--unread, .nim-dialog.nim-dialog_unread.nim-dialog_prep-injected.nim-dialog_muted .nim-dialog--unread, .im-page .im-page--history-new-bar:after, .im-page .im-page--history-new-bar:before, .box_title_wrap, .box_controls, .im-mess.im-mess_unread:not(.im-mess_light), .im-page-pinned, .im-mess.im-mess_light, #wk_box, .wl_post_reply_form_forbidden, .top_nav_btn.active, .top_nav_btn:hover, .top_notify_show_all, .ui_tabs.ui_tabs_box, .replies_open, .wr_header, .emoji_cat_title, .im-page.im-page_classic.im-page_group .im-group-online, .page_media_poll_wrap, .wall_comments_header, .wall_module .page_media_thumbed_link, .emoji_tab_sel, .emoji_tab_sel:hover, .emoji_tabs_l_s, .emoji_tabs_r_s, .im-page_classic.im-page .im-chat-history-resize, .im-mess.im-mess_selected+.im-mess:before, .im-mess.im-mess_unread+.im-mess:before, .im-create .im-creation--item:hover, #feed_wall, .wk_extpage_footer_wrap, .audio_row__more_actions .audio_row__more_action:hover, .top_audio_player:hover, .top_nav_link.active, .top_nav_link:hover, .summary_tab2:hover, a.group_ad_post_link, a.group_ad_post_stats, .im-dropbox--rect.dropbox_over, .online.mobile:after, .search_focused .highlight, .fc_tab_head, .fc_msgs, .fc_tab_notify, .audio_pl_snippet, .ap_layer .audio_pl_snippet .audio_pl_snippet__header_inner, #ads_edit_audience, .ads_edit_link_type_card, .page_media_poll .page_poll_row, .im_stickers_buy_header, .wall_module .wl_replies .reply, .owner_photo_additional, .msg, .chat_tab_typing_wrap, .video_choosebox_bottom, .post_upload_dropbox.dropbox_over .post_upload_dropbox_inner, .fc_msgs_unread, .scrollbar_inner, .scrollbar_inner:hover, .scrollbar_hovered, .medadd_c_linkcon, .photos_edit_selection_header, .photos_container_edit_grid .photos_photo_edit_row, .dropbox, .exchange_table th, .dev_const_params, #group_apps_list .group_apps_list_rows .group_apps_list_row .group_apps_edit, .flist_sel, .wcomments_head, .video_choose_upload_area, .group_api_url_desc, .PopupHeader, .ChatSettings__content, .SubmitArea, .dropbox_over .photos_choose_upload_area_drop, .photos_choose_upload_area_enter .photos_choose_upload_area_drop, .piechart_col_header th, .wke_controls, .wk_poll_tabs, .wk_poll_dmgr, .gifts_box_header, .docs_choose_dropbox_wrap, .paginated_table_header, .paginated_table_header th.paginated_table_cell, .round_tab.selected, .round_tab.selected:hover, .market_item_content, .GroupChatInvites, .MessageForward__content, .MessageForward__footer, .tickets_thank_you_form, .market_item_photo_container, .apps_edit_run_panel, .article, .cal_table .month, .cal_table .month_arr, .article_snippet.article_snippet_mini .article_snippet_mini_info_block, .tickets_block_link, #apps_layer .apps_header, .apps_i_wrap, .apps_install_header, .apps_i_policy, #apps_addr_table, #app_domain, body.author_page_body, .author_page_layer, .mv_is_in_progress, .media_link__label, .thumbed_link__thumb, .thumbed_link--chat-invitation, .thumbed_link__label, .audio_pl_snippet2, .im-to-end__button, .apps_settings_icons .apps_settings_payments, .apps_settings_icons .apps_settings_stats, .apps_settings_icons .apps_settings_payments:hover, .apps_settings_icons .apps_settings_stats:hover, .im-page .im-page--error, .im_stickers_store_wrap .ui_tabs, .im_stickers_bl_wrap, .im-money-request-snippet, #groups_menu_items .groups_edit_menu_items .groups_edit_menu_item.preview_placeholder .groups_edit_menu_item_header .groups_edit_menu_item_preview, .Button--secondary, .im-navigation--to-end .im-navigation__button, .PeerProfile, .Modal__header--blue, .ChatSettingsMembersWidget__add:before, .im-navigation--to-mention .im-navigation__button, .im-audio-message-input .im-audio-message-track, [dir] .thumbed_link--invitation, [dir] .StickerPackPreview__items, [dir] .StickerPackPreview__copyrights, [dir] .nim-dialog.nim-dialog_pinned+.nim-dialog:not(.nim-dialog_pinned)::before, [dir] .ModalHeader--blue, [dir] .CommunityChatCreation .ModalBody, [dir] .thumbed_link--group-invitation, [dir] .MiniAppsSnippet--small .MiniAppsSnippetFields, [dir] .medadd_c_linkcon .MiniAppsSnippetFields, [dir] .video_add_external, [dir] .MiniAppsSnippet--big .MiniAppsSnippetBottom, [dir] .medadd_c_linkimg_big .MiniAppsSnippetBottom, [dir] .groups_cover_box .groups_edit_cover_wrap .groups_edit_cover_wrap_live .groups_edit_cover_wrap_live_previews .groups_edit_cover_wrap_live_upload .groups_edit_cover_wrap_live_upload_placeholder_disabled, [dir] .market_item_content_bottom, [dir] .ModalHeader--white, [dir] .cal_clear, [dir] .cal_table .day, [dir] .DonutLinkSnippet, [dir] .DonutSubscribePopup__donatorAdvantages, [dir] .ReactionsMenu, [dir] .ui_gallery_wall_cards .wall_card, [dir] .emoji_shop, ._3nkNC0nOut45P4pyFllZcd, [dir] .ModalHeader, [dir] .im-top-banner, [dir] .gift_tt_show_all, [dir] .im-page .im-page--dialogs-archive-notice-w, [dir] .im_stickers_my_row.sort_taken, [dir] .im_stickers_my_row.sort_taken:last-child, [dir] .landing_author_guide_content, [dir] .wpost_post {background-color: %very_gray%;}
input, #page_header_cont .back, .page_block, .profile_info_header, .profile_info_edit, .fakeinput, div[contenteditable=true], input.big_text, input.dark, input.search, input.text, textarea, .submit_post, #side_bar ol li .left_row:hover, .wall_module .reply_fakebox, .wall_module .reply_box, .wall_module .reply_fakebox_wrap, .wall_module .reply_form, .ui_actions_menu, .page_actions_wrap, .page_actions_header, .ms_items_more, .pv_cont .narrow_column, .pv_author_block, .tt_default, .tt_default_right, .im-page_classic.im-page .im-page--dcontent, .im-page .im-page--dialogs-footer.ui_grey_block, .ui_search, .im-page_classic.im-page .im-page--dialogs-search, .im-page_classic.im-page .im-page--chat-body-wrap-inner, .im-page--toolsw, .im-page_classic.im-page .im-page--chat-body-abs, .im-page_classic .im-page--chat-header-in, .im-page .im-page--history-new-bar, .im-chat-input.im-chat-input_classic, .im-chat-input, .im-page .im-page--header, .im-page .im-page--search-header, .im-mess.im-mess_selected:last-child:before, .im-mess.im-mess_unread:last-child:before, .box_body, .chat_onl_inner, #top_notify_wrap, .top_notify_cont .feedback_row:not(.dld).hover, .top_notify_cont .feedback_row:not(.dld):hover, .top_notify_show_all:hover, .pv_white_bg, .photos_container .photos_row, .emoji_tt_wrap, .ui_tabs_header, .page_block_header, .photos_choose_upload_area, .web_cam_photo, .docs_choose_upload_area, .im-page.im-page_classic.im-page_group .im-group-online .im-group-online--inner, .stl_active.over_fast #stl_bg, .mv_info, .selector_container, .result_list ul, div.wdd, .emoji_tabs, .wddi, .ui_scroll_default_theme>.ui_scroll_bar_container>.ui_scroll_bar_outer>.ui_scroll_bar_inner, .ts_cont_wrap, .im-page .im-page--history-new-bar>span, .im-create .im-create--tabs, .im-create .im-creation--item.im-creation--item_hovered, .im-create .im-creation--item, .im-create, .im-create.im-create_classic .im-create--table, .im-create.im-create_classic .im-create--footer, .wk_text blockquote, .docs_panel, .audio_layer_container .audio_page_player, .audio_page_player .audio_page_player__cover, .eltt, .ui_search_sugg_list, .audio_page_layout .audio_friends_list, .wk_table th, .tickets_post_field, .faq_tabs.ui_tabs, #top_profile_menu, .mention_tt_actions, .im-page .im-page--mess-search, .ui_tab_group_items, .page_block_info, .group_l_row, .mail_box_cont, .im-dropbox, .wall_module .reply, .replies_side, .fc_tab, div.fc_tab_txt, #fc_contacts, .fc_content, div.fc_clist_filter_wrap, .round_button, .ads_edit_page_wrap3, .apps_options_bar, .apps_cont_msg, .apps_footer, .wl_replies_header.wl_replies_header_clickable:hover, .group_tokens_row, .gedit_block_footer, .ui_table tr.ui_table_row, .privacy_dropdown .header, .settings_block_footer, #mv_pl_tt .mv_tt_add_playlist, .idd_popup .idd_items_content, .idd_popup .idd_header_wrap, .post_upload_dropbox, #dev_page_wrap1, .dev_page_block, #dev_top_nav_wrap, .shorten_list_row, #dev_left_nav, .dev_section_methods_wrap, .dev_section_methods_wrap .dev_section_search_result_wrap, #ads_page, #ads_page_bottom_info, .exchange_not_found.table, .dark_box_cont, .help_table_question_sa.help_table_question_visible, .dev_req_result, .apps_edit_retina_info, .apps_edit_nav_header, .photos_period_delimiter_fixed, .wcomments_form, .wcomments_mini #page_wrap, .ChatSettingsInfo, .List, .List--border, .ChatSettingsMembersWidget, .Button--mobile, .ChatSettingsInvitationLink, .PopupHeader__backBtn:hover, .Dropdown__in, .wke_b:hover, .box_msg, .box_msg_gray, .MultiSelect__search, .ChatSettingsMembers, #wl_postreach_stat_body, #stat_group_postsreach_table td, .page_status_editor .editor, .ListItem--active, .ListItem--can-be-hovered.ListItem--selectable:hover, .Button--tertiary:not(.Button--disabled):focus, .Button--tertiary:not(.Button--disabled):hover, .media_voting, #group_apps_list .group_apps_list_rows.group_apps_list_rows_multi .group_apps_list_row_drag_wrapper, .TemplatesDropDown__container, .im_cal_clear, .cal_table .daysofweek, a.ts_contact.active, a.ts_search_link.active, .deep_active .replies .reply_box_inner_wrap.fixed, .bt_report_footer, .bt_comment_form_unavailable, .bt_prod_one_photo__img, .feedback_row_clickable:not(.feedback_row_touched):hover, .bt_comment_form_actions, .bt_report_sidebar_wrap, .bt_report_footer .reproducing .user_img, .bt_report_footer .reproducing .common_count, .bt_report_cmt_img, .apps_edit_img_wrap, .groups_edit_event_log_page .groups_edit_event_log_controls, .im_stickers_my_tip, .sticker_hints_tt, .sticker_hints_arrow, .wall_module:not(.search_results) .post--with-likes:not(.post_copy):not(.post_btl):not(.post_wf):not(.post_fr_likes) .wall_text .media_link:last-child, #groups_menu_items .groups_edit_menu_items .group_apps_list_row_drag_wrapper, #groups_menu_items .groups_edit_menu_items .groups_edit_menu_item .groups_edit_menu_item_settings, .ChatSettingsInfo__photoGrid, .ChatSettingsInfo__photoSelf, .audio_page_layout .audio_search_wrapper, .audio_page_player2.audio_page_player_fixed, .BaseModal__content, .Modal__footer, .Select__menu, .Select--opened .Select__control, .CatalogBlock--divided, .CatalogSection, .im-audio-message-input, .ChatCreation__content, .ChatCreation .Modal__body, [dir] .ChatSettingsPresetPanel, [dir] #page_header_cont, [dir] .StickerPackPreview__header, [dir] .StickerPackPreview__footer, [dir] .RightMenuBlock, [dir] .ModalFooter, [dir] .CommunityChatCreation__content, [dir] .PageBlock, [dir] .post_top_info_caption, [dir] .audio_pl_edit_box .ape_add_audios_btn, [dir] .audio_pl_edit_box .ape_add_pl_audios_btn, [dir] .box_title .back:hover, [dir] .video_add_external:hover, [dir] .audio_pl_edit_box .ape_list_header, [dir] .groups_cover_box .groups_edit_cover_header, [dir] .ui_search_new.ui_search_field_empty .ui_search_button_search, [dir] .group_page_block_footer, [dir] .PostBottomAction, [dir] .AppsCatalogHeader, [dir] .selector_container table.selector_table, .FCThumb, .FCPanel__add, .FCWindow, [dir] .im_sticker_bl, [dir] .audio_layer_container .ui_tabs {box-shadow: none; background-color: %slightly_gray%;}
.button_gray button.hover, .button_gray button:hover, .flat_button.secondary.hover, .flat_button.secondary:hover, .button_blue button.hover, .button_blue button:hover, .flat_button.hover, .flat_button:hover, .pv_cont .pv_comments_header:hover, .exchange_subtab1:hover, .media_voting_footer_button:hover, .media_voting_option_bar, .media_voting_option_leader .media_voting_option_bar, .im-replied:hover:before {background-color: %slighterer_gray_hovered%;}
.my_current_info:hover, .profile_more_info_link:hover, #profile_groups_link:hover, .left_count_wrap, .button_gray button, .flat_button.secondary, .wall_module .post_like:hover, .wall_module .post_reply:hover, .wall_module .post_share:hover, .button_blue button, .button_gray button, .button_light_gray button, .flat_button, .ui_actions_menu_item:hover, .page_actions_item:hover, .media_selector .ms_items_more .ms_item:hover, .pv_like:hover, .pv_cont .pv_can_edit:hover, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_hovered, .nim-dialog:not(.nim-dialog_deleted):hover, .ui_rmenu_item:hover, .ui_rmenu_subitem:hover, .ui_rmenu_item_sel, .ui_rmenu_item_sel:hover, .im-mess.im-mess_selected:not(.im-mess_is_editing), .im-mess.im-mess_selected:not(.im-mess_is_editing):hover, .chat_tab_wrap:hover, .im-mess.im-mess_search:hover, .audio_row:hover:not(.audio_row__current) .audio_row_content, .emoji_bg, .photos_choose_upload_area:hover, .web_cam_photo:hover, .docs_choose_upload_area:hover, .docs_choose_rows .docs_item:hover, .ui_ownblock:hover, #mv_comments_header, .result_list ul li.active, .feedback_row_wrap.unread:not(.feedback_row_touched), .im_msg_audiomsg .audio-msg-track:not(.audio-msg-player):hover, .summary_tab_sel .summary_tab2, .summary_tab_sel .summary_tab2:hover, .wddi_over, a.ts_contact.active, .im-mess.im-mess_selected+.im-mess:before, .emoji_tab:hover, .emoji_shop:hover, .ui_multiselect_cnt .token, .ui_search_filters_pane .token, .audio_pl_edit_box .ape_add_audios_btn:hover, .audio_pl_edit_box .ape_add_pl_audios_btn:hover, .ui_search_sugg_list .ui_search_suggestion_selected, .audio_page__shuffle_all .audio_page__shuffle_all_button:hover, .audio_layer_container .audio_friend:hover, .post_from_tt_row.active, .post_from_tt_row:hover, .tickets_header, .audio_row.audio_row__current .audio_row_content, .tu_last:hover, .top_profile_mrow:hover, .im-page .im-page--mess-search:hover, .ui_tabs .ui_tab_group_item:hover, .prefix_input_wrap, .group_ad_info_link:hover, .group_ad_header, .blst_last:hover, .replies_side:hover, .fc_msgs_out .fc_msgs, a.fc_contact_over, .round_button:hover, .olist_item_wrap:hover, .tabbed_box .summary_tab .summary_tab3:hover, .tabbed_box .summary_tab_sel .summary_tab3:hover, .tabbed_box .summary_tab_sel a:hover, .tabbed_box .summary_tab a:hover, .page_media_poll .page_poll_percent, .im-mess.im-mess_gift, .pv_cont .pv_comments_header, .privacy_dropdown .item_sel, .privacy_dropdown .item_sel_plus, #mv_pl_tt .mv_tt_add_playlist:hover, .idd_popup .idd_item.idd_hl, .idd_popup .idd_item:active, .idd_popup .idd_item.idd_hover, .idd_popup .idd_item.idd_hover_sublist_parent, .dev_methods_list_row:hover, .im-popular--unread, .dev_top_link.sel, .dev_top_link.sel:hover, .pr_bt, .dev_nav a.nav.nav_selected, .dev_nav a.nav.nav_selected:hover, .dev_nav .nav:hover, .dev_section_methods_wrap .dev_section_search_result_item.over, .group_activity_row_wrap .group_obscene_word, .exchange_subtab1.active, .ads_main_notice, .help_table_question_visible, .flist_item_wrap:hover, .app_edit_block_header, .preq_wrap, .ok_msg, .EditableLabel:hover .EditableLabel__text, .ListItem--selectable:hover, .Button--mobile:hover, .Dropdown__item:hover, .graph_menu_item.graph_menu_item_sel, .graph_menu_item.graph_menu_item_sel:hover, .medadd_inline_editable:hover, .MultiSelect__token, .media_voting_option, .media_voting_footer_button, .page_photo.page_action_menu_groups .group_notification_settings .group_notification_setting.on, .apps_edit_cont_row.active>.apps_edit_cont_name_c, .apps_edit_cont_name_c, .TemplatesDropDown__item:hover, .settings_separated_row+.settings_separated_row:after, .post_edit_settings_wrap:before, .im-replied:before, .links-list__item:hover, .bt_reporter_row:hover, .bt_tag_label, .bt_report_cmt_meta_content, .group_info_rows_redesign .group_info_row.onboarding_placeholder .line_value:hover, .dev_home_link:hover, .dev_top_link:hover, .wk_hider_header, .pages_header_info, .pages_history_header_wrap, .eltt .eltt_fancy_action:hover, .groups_edit_event_log_page .groups_edit_event_log_items_wrap .groups_edit_event_log_item_wrap:hover>.groups_edit_event_log_item_main, .groups_edit_event_log_page .groups_edit_event_log_items_wrap .groups_edit_event_log_item_wrap_focused, .ui_tooltipMenu__link:hover, .mv_desc .can_edit:hover, .audio_pl_snippet2 .audio_shuffle_all_button:hover, .emoji_sticker_item.over, .emoji_sticker_item:hover, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_selected, .BugreportComment__metaContent, #groups_menu_items .groups_edit_menu_items .groups_edit_menu_item .groups_edit_menu_item_line, .Select__option--selected, .Select__option:hover, #pv_more_acts_tt .pv_more_act_item:hover, [dir] .top_profile_vkconnect_row:hover, [dir] .ChatSettingsPresetPanel__preset--selected, [dir] .tickets_reply_text_quote, [dir] .ProfileEditorVkconnect__notice, [dir] .ui_rmenu_vkconnect_row:hover, [dir] .im-mess.im-mess_gift, [dir] .groups_cover_box .groups_edit_cover_wrap .groups_edit_cover_wrap_live .groups_edit_cover_wrap_live_previews .groups_edit_cover_wrap_live_upload .groups_edit_cover_wrap_live_upload_placeholder_enabled:hover, [dir] .FlatButton--primary, [dir] .FlatButton--secondary, .FCConvoListItem:hover, .FCConvoListItem[aria-selected='true'], .ConvoMessage, [dir] .im-right-menu .im-right-menu--counter[data-tab=archive], [dir] .CatalogBlock__layout--in_block_separator {background-color: %slightly_gray_hovered%;}
#side_bar .left_icon, #side_bar ol li .left_row:hover, .media_selector .ms_item:before, .media_selector .ms_item:hover, input.text.ts_input, .wall_module .post_like_icon, .wall_module .post_reply_icon, .wall_module .post_share_icon, .wall_module .post_views_icon, .ui_tab_plain, .like_btn, .wall_module .reply_action, .wall_module .reply .reply_action:hover, .checkbox:before, .pv_like_icon, .page_doc_row .page_doc_icon, .topics_module .topic_icon, a.groups_messages_block:before, .ui_actions_menu_item.im-action:hover:before, .ui_actions_menu_item.im-action:before, .im-right-menu .im-right-menu--close:before, .audio_row .audio_row__action_next, .audio_pl_edit_box .ape_add_audios_btn:before, .audio_pl_edit_box .ape_add_pl_audios_btn:before, .audio_pl_edit_box .ape_add_audios_btn:after, .audio_pl_edit_box .ape_add_pl_audios_btn:after, .ui_calendar_icon, .ui_calendar_icon:hover, .im-mess .im-mess--check, .im-page--chat-header_actions .im-page--mess-actions, .im-page .im-page--dialogs-settings, .im-page--back-btn, .im-to-end, .chat_onl_cont, .top_nav_btn#top_notify_btn .top_nav_btn_icon, .top_nav_btn#top_audio:hover .top_nav_btn_icon, .top_nav_btn#top_audio .top_nav_btn_icon, .web_cam_photo_icon, .photos_choose_upload_area_label, .docs_choose_upload_area_label, .left_settings_inner, .ui_toggler, .box_x_button.box_x_tabs, .wall_module .my_like .post_like_icon, .wall_module .my_share .post_share_icon, .sort_not_rev_icon, .sort_rev_icon, #stl_text, .audio_row .audio_row__play_btn, .im-dialog-select .im-dialog-select--btn, .im-page--header-icon_answer:before, .im-page--header-icon_star:before, .im-page_classic.im-page .im-page--gim-mute, .audio-msg-track .audio-msg-track--wave-wrapper .audio-msg-track--wave, .audio-msg-track .audio-msg-track--btn, .feed_filter_icon, .feed_lists_icon .ui_actions_menu_icons, .page_actions_cont.narrow .page_actions_header, .page_actions_cont.narrow .page_extra_actions_btn, .wdd_add, .im-chat-input .im-chat-input--send, .emoji_smile_icon_vector, .im-chat-input .im-chat-input--attach-label, .ms_items_more_wrap.ms_items_more_wrap_vector .ms_item_more_label, .im-page_classic .im-page--chat-header_muted .im-page--title-main-in:after, .im-page--header-icon.im-page--header-icon_search:before, .im-page--header-more .ui_actions_menu_icons, .nim-dialog .nim-dialog--markre, .nim-dialog .nim-dialog--star, .ts_contact_status, .im-mess .im-mess--fav, .im-mess .im-mess--reply, .im-mess .im-mess--edit, .olist_checkbox, .ui_multiselect_cnt .token .token_del, .ui_search_filters_pane .token .token_del, .wall_module .media_desc b, .wall_module .media_preview .note b, .wall_module .media_preview .poll b, .wall_module .media_preview .share b, .page_upload_label, .box_body .ui_box_search, .radiobtn, .emoji_smile_icon, .audio_page_player .audio_page_player__cover, .audio_page_player .audio_page_player_ctrl, .ui_search_new .ui_search_button_search, .audio_w_covers .audio_row .audio_row__cover, .audio_page__shuffle_all .audio_page__shuffle_all_button:before, .nim-dialog .nim-dialog--close, .nim-dialog.nim-dialog_muted .nim-dialog--mute, .nim-dialog.nim-dialog_unread.nim-dialog_prep-injected.nim-dialog_muted .nim-dialog--mute, .audio_row.audio_row__current .audio_row_content, .selector_container td.selector .token, .pedit_add_row, .im-page .im-i--messages-search, .apps_cat_header_link:after, .app_rate, a.group_ad_post_link, a.group_ad_post_stats, .group_l_row .group_l_delete, .group_l_row .group_l_edit, .group_l_row .group_l_progress, .blst_closed, .blst_fixed, .bp_action, .im-dropbox--icon-doc, .im-dropbox--icon-photo, .im-fwd .im-fwd--close, .audio_row .audio_row__action_more, .audio_row .audio_row__action_add, .audio_row .audio_row__action_restore_listened, .audio_row .audio_row__action_restore_recoms, .replies_side, .fc_tab_attach .media_selector .ms_item_more, .chats_sp, .audio_pl_snippet .audio_pl_snippet__action_btn, .audio_pl_snippet .audio_pl_snippet__more_btn:before, .audio_pl_snippet_play_small, .ads_edit_link_type_card_image_group, .ads_edit_link_type_card_radio, .ui_actions_menu_icons, .im-mess--cancel-edit, .box_title_wrap.box_grey .box_x_button, .ui_search_custom input.ui_search_field, .page_media_poll .page_poll_row.page_poll_voted:before, .im-page-pinned--hide, .im-page-pinned:before, .wall_signed_by, .page_cover_image .ui_actions_menu_item:before, .owner_photo_cover_image, .ui_search_input_block, .privacy_locked, .docs_action_icon, .mv_share_button .mv_share_icon, .mv_add_button .mv_add_icon, #mv_pl_tt .mv_tt_playlist_private_icon, #mv_pl_tt .mv_tt_add_playlist .mv_tt_plus_icon, .idd_wrap .idd_arrow, .group_info_row:before, .wk_subscribe_icon, .ui_progress .ui_progress_bar, .media_preview .progress_x, .im-page .im-page--history.im-page--history_loading:before, .profile_gift_send_btn .send_thumb, .fc_msg_att_icon_doc, .fc_msg_att_icon_mail, .fc_msg_att_icon_wall, .wall_module .reply_to_title .reply_to_cancel, .checkbox_official:after, .page_docs_preview .page_media_x_wrap .page_media_x, .im-page--selected-messages-remove, .idd_popup .idd_item.idd_sublist, .friends_possible_link, .group_online_answer_pict, .dropbox, .upload_progress, .ui_rmenu_item_arrow, .gift_delete, .top_audio_play__button, .audio_claim_popup, .checkbox_container table td .checkbox_off, .checkbox_container table td .checkbox_off_over, .checkbox_container table td .checkbox_on, .checkbox_container table td .checkbox_on_over, .tickets_tt_list, .tickets_tt_list_abuse, .flist_item_checked .flist_item_action, .flist_list_nomargin .flist_item_wrap.flist_item_checked:hover .flist_item_action, .privacy_dropdown .header, .ChatSettingsMembersEdit__actions, .Button--primary, .photos_choose_upload_area_drop_label, .wke_b, .info_msg, .ChatSettingsMembersWidget__add:before, .ChatSettingsMembersWidget__searchIcon:before, .MultiSelect__tokenRemove, .ChatSettingsMembers__entity--selected:after, .like_views, .docs_choose_dropbox, .im-chat-input .im_chat-input--keyboard-button, .ui_actions_menu_sublist .ui_actions_menu_item, .market_fav_btn_icon, .media_voting_multiple .media_voting_option_text:after, .pv_comments_list .ms_item_more, .pv_reply_form .ms_item_more, .page_photo.page_action_menu_groups .page_actions_item:before, .TemplatesDropDown__icon, .gift_send_btn, .settings_apps .apps_settings_action_edit, .settings_apps .apps_settings_action_remove, .hint_icon:after, .page_actions_btn.narrow.stats, .mv_subscribe_block .mv_subscribe_live_btn:before, .mv_subscribe_block #mv_subscribed_btn:before, .button_action_light:hover::before, .button_action_light::before, .im-replied-container--remove, .deep_active .replies .reply_box_more_attaches, .wall_module .reply_box_photo, .deep_active .replies .reply_send_button, .deep_active.wall_module .replies .reply_send_button, .deep_active.wall_module .wl_replies_block_wrap .reply_send_button, .deep_active .wl_replies_block_wrap .reply_send_button, .links-list__button, .deep_active .replies .reply_fakebox .reply_fake_more_attaches, .bt_report_additional_actions, .bt_report_fav, .bt_reports_reverse_button, .group_info_rows_redesign .group_info_row.onboarding_placeholder .line_value:hover .line_div_icon, .audio_pl_snippet2 .audio_pl_snippet__more_btn:before, .audio_pl_snippet2 .audio_shuffle_all_button:before, .audio_pl_snippet2 .audio_pl_snippet__action_btn_listen:before, .audio_pl_snippet2 .audio_pl_snippet__action_btn_share:before, .audio_pl_snippet2 .audio_pl_snippet__action_btn_add:before, .post_action_btn .post_action_image_btn._close, .apps_settings_icons .apps_settings_payments, .apps_settings_icons .apps_settings_stats, .ChatSettingsMembersEdit__kick, .im-navigation--to-end .im-navigation__button, .icon, .btn_icon, .audio_page_player_volume_slider, .im-navigation--to-mention .im-navigation__button, [dir] .im-page--header-icon_call::before, [dir] .TopSearch__input, [dir] .nim-dialog.nim-dialog_pinned .nim-dialog--pinned-conversation, [dir] .TopNavBtn.TopNavBtn__notify .TopNavBtn__icon, [dir] .top_audio_player .top_audio_player_btn .top_audio_player_btn_icon, .ProfileActions .page_actions_expanded .page_actions_item::before, [dir=ltr] .LeftNav__icon, [dir=ltr] .LeftMenu__icon, [dir] .video_add_external, .TopNavBtn:nth-child(2), .TopNavBtn svg, .PopupHeader__closeBtn, .PageActionCell__icon, [dir] .PostBottomAction--withBg, [dir] .media_selector .MediaSelector__mediaIcon {filter: %grayscale%}
.nim-dialog:not(.nim-dialog_deleted).nim-dialog_unread.nim-dialog_classic {background-color: %unread_message%;}
.ui_rmenu_sliding .ui_rmenu_slider, .feed_new_posts>b, .nim-dialog.nim-dialog_starred:before, .ListItem--border:before {background-color: %okay_gray%;}
.im-page--back-btn:hover, .im-chat-input .im-chat-input--txt-wrap, .emoji_cats_title_helper:after, .im-group-online-box .im-group-online-box--top, [dir] .im-chat-input .im-chat-input--txt-wrap, [dir] .Select__control, [dir] .im-navigation__button::before, [dir] .audio_search.ui_search_new .ui_search_input_inner, [dir] .landing_wk_wrap_group_week_stat .landing_author_guide_header__footer {background: none;!important}
.im-member-item .im-member-item--photo img {background-color: none;}
.privacy_dropdown .body {background-color: %slightly_gray_1%;}
.im-page_classic.im-page .im-page--history_loading, .idd_popup, .bt_report_cmt_meta_content, .BugreportComment__metaContent, .PeerProfile, .CatalogBlock--divided:before, .CatalogSection:before, [dir] .like_cont, [dir] .post--withPostBottomAction.post--withActionStatusBar .wall_post_cont .Post__copyright:last-child, .FCPanel__list {box-shadow: none;}
.emoji_tabs_l_sc, .emoji_tabs_r_sc, .ui_scroll_default_theme.ui_scroll_emoji_theme>.ui_scroll_overflow>.ui_scroll_shadow_bottom, .ui_scroll_default_theme.ui_scroll_emoji_theme>.ui_scroll_overflow>.ui_scroll_shadow_top {display: none;}
.im_stickers_close:after {filter: invert()!important}
/* == BORDER COLORS == */
#page_header_cont .back, [dir] .StickerPackPreview__header, [dir] .ModalHeader--white, [dir] .PopupHeader, [dir] .ModalHeader {border-bottom: none;}
.submit_post, .module, #ads_left.ads_left_empty+.left_menu_nav_wrap, #side_bar .more_div, .wall_module .copy_quote, .post_full_like_wrap, .wall_module .replies_list, .wall_module .reply~.reply .dld, .wall_module .reply~.reply .reply_wrap, .wall_module .reply_box, .wall_module .reply_fakebox_wrap, .ui_tab_sel, .ui_tab_sel:hover, .ui_tabs .ui_tab_sel, .ui_tabs .ui_tab_sel:hover, .ui_tabs_box .ui_tab_sel, .ui_tabs_box .ui_tab_sel:hover, .page_actions_inner, .pv_author_block, .post_publish, .nim-dialog:not(.nim-dialog_deleted).nim-dialog.nim-dialog_classic.nim-dialog_unread, .nim-dialog:not(.nim-dialog_deleted).nim-dialog.nim-dialog_hovered, .nim-dialog:not(.nim-dialog_deleted).nim-dialog:hover, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_hovered+.im-search-results-head, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_hovered+.nim-dialog, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_selected+.im-search-results-head, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_selected+.nim-dialog, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_unread.nim-dialog_classic+.im-search-results-head, .nim-dialog:not(.nim-dialog_deleted).nim-dialog_unread.nim-dialog_classic+.nim-dialog, .nim-dialog:not(.nim-dialog_deleted):hover+.im-search-results-head, .nim-dialog:not(.nim-dialog_deleted):hover+.nim-dialog, .nim-dialog .nim-dialog--content, .im-page .im-page--dialogs-footer, .ui_rmenu_item_sel, .ui_rmenu_item_sel:hover, .im-page--toolsw, .ui_actions_menu_sep, .im-chat-input, .im-page .im-page--top-date-bar, .im-chat-input .im-chat-input--txt-wrap, .pv_comments, .ui_search_filters_pane, .im-page .im-page--history-new-bar:after, .im-page .im-page--history-new-bar:before, .im_fwd_log_wrap, .im_wall_log_wrap, .im-member-item, .box_controls, .im-page-pinned, .im-to-end .im-to-end--label, .wl_post_reply_form_forbidden, .feed_row~.feed_row .feedback_row, .feed_row~.feed_row .feedback_sticky_row, .feed_row~.feed_row_fb_hidden .feed_row:first-child .feedback_row, .feedback_sticky_rows:not(:empty)+.feed_row .feedback_row, .feedback_sticky_rows:not(:empty)+.feed_row .feedback_sticky_row, .top_notify_header, .top_notify_show_all, .ui_tabs.ui_tabs_box, .box_title_wrap.box_grey, .flat_button.ui_load_more_btn, .friends_user_row, .docs_choose_rows .docs_item, .wall_comments_header, .wl_replies_header, .wall_module.wl_post .reply .reply_wrap, .top_nav_btn:hover .top_notify_count, .top_notify_count, .im-mess .im-mess--post, .profile_msg_split .profile_btn_cut_left, .profile_msg_split .profile_btn_cut_right, .wddi, .wddi_over, div.wdd, .fakeinput, .fakeinput~.placeholder .ph_input, input.big_text, input.big_text~.placeholder .ph_input, input.dark, input.dark~.placeholder .ph_input, input.search, input.search~.placeholder .ph_input, input.text, input.text~.placeholder .ph_input, textarea, textarea~.placeholder .ph_input, .im-fwd, .ui_tabs, .im-create .im-creation--item.im-creation--item_hovered, .im-create .im-creation--item:hover, .olist_item_wrap, .ui_search, .ui_grey_block, .search_results_sep, .wk_extpage_footer_wrap, .wk_text blockquote, .page_actions_separator, .audio_pl_edit_box .ape_add_audios_btn, .audio_pl_edit_box .ape_add_pl_audios_btn, .audio_layer_container .audio_page_player, .eltt, .ui_search_new .ui_search_button_search, .ui_search_new .ui_search_input_inner, .ui_search_sugg_list, .audio_page_layout .has_friends_block .audio_page__rows_wrap, .wk_table, .wk_table th, .wk_table td, .tickets_header, .tickets_post_form__panel, .tickets_post_field, .page_block_header, .tu_row, .tickets_reply_row, .help_table_question, .top_profile_sep, .selector_container table.selector_table, .result_list, .mention_tt_actions, .im-page .im-page--mess-search, .ui_tab_group_items, .ui_tab_group_separator, .page_block_info, .pages_bottom .pg_lnk_sel .pg_in, .group_ad_header, .group_l_row, #mail_box_editable, .ui_rmenu_sep, .group_box_row, .blst_row, .bp_post, .pg_lnk_sel .pg_in, .bt_header, .im-dropbox--rect, .story_feed_new_item .stories_feed_item_ava, .audio_pl_snippet, .audio_pl_snippet .audio_pl_snippet__header, a.ads_edit_link_go, .ads_edit_separator_big, .tabbed_box .summary_tab_sel, #apps_user_warning_cont, .apps_options_bar, .apps_footer, .im_stickers_buy_header, a.group_app_button_multi, .wall_module .media_desc .lnk.lnk_mail, .owner_photo_additional, .gedit_block_footer, .groups_api_divider, .group_api_requests_table.ui_table tr.ui_table_row, .msg, .wide_column .page_top, .counts_module, .profile_info_block, .settings_privacy_row, .settings_block_footer, .settings_bl_row, .docs_item, #mv_pl_tt .mv_tt_add_playlist, .group_list_row, .video_choosebox_bottom, .post_upload_dropbox_inner, .mv_comments_summary, .media_selector .ms_item.ms_item_article, .photos_edit_selection_header, .photos_container_edit_grid .photos_photo_edit_row_desc_placeholder, .dropbox_area, .upload_progress_wrap, .shorten_list_row, .dev_nav a.nav.nav_selected, .dev_nav a.nav.nav_selected:hover, .dev_section_methods_wrap .dev_section_search_wrap, .dev_method_block .dev_method_block_title, #ads_page_bottom_info, .exchange_title_head, .exchange_table tr, .exchange_table tr:first-child, .ads_main_notice, .help_table_questions, .dev_method_req_table, .dev_const_params, #group_apps_list .group_apps_list_rows .group_apps_list_row .group_apps_edit, .flist_sel, .flist_item_wrap, .app_edit_block_header, .apps_edit_screen_line, .apps_edit_nav_header, .apps_edit_embedded_control_container, div[contenteditable=true], .wcomments_post .reply_box_inner_wrap .reply_fakebox, .wcomments_post .reply_box_inner_wrap .reply_field, .wcomments_post .reply_box_inner_wrap .reply_field~.placeholder .ph_input, .preq_tt, .wide_column .topics_module .topic_row, .ListItem--selectable:hover, .Tabs, .SubmitArea, .dropbox_over .photos_choose_upload_area_drop, .photos_choose_upload_area_enter .photos_choose_upload_area_drop, .piechart_table tr td, .im-group-online-box .im-group-online-box--top, .im-group-online-box .im-group-online-box--description, .wke_controls, .box_msg, .box_msg_gray, .media_preview_has_medias, .ChatSettingsMembersWidget__add:before, .MultiSelect__search, .ChatSettingsMembers__entity--selected:after, .wk_poll_tabs, .wk_poll_dmgr, .docs_choose_dropbox_wrap, #wl_postreach_stat_body, .paginated_table_header, #stat_group_postsreach_table td, .stats_time_info, .page_status_editor .editor, .pedit_separator, .dev_param_row, .market_item_footer_info, .market_comments_summary, input.BlockSearchInput, .ListItem--active, .ListItem--can-be-hovered.ListItem--selectable:hover, .MessageForward__footer, .group_edit_row_sep, .group_tokens_row, .media_voting, .dev_version, .app_widget_list_row, .tickets_thank_you_form, #stats_cont h4, .stats_head, .message_page_title, .search_row, .settings_line, .module_header.header_separated, .apps_settings_row_wrap, .settings_apps .apps_settings_row_wrap, .apps_edit_user, .dev_wide_input_wrap, #group_apps_list .group_apps_list_rows .group_apps_list_row, .apps_edit_run_panel, .apps_edit_code_panel, .TemplatesDropDown__container, .gifts_box_rows .post, .settings_block_msg, .settings_history_table tr td, .cal_table, .apps_group_catalog_rows .apps_catalog_row, .apps_group_catalog_header, .mv_actions_block, .mv_subscribe_block .mv_subscribe_live_btn, .article_snippet.article_snippet_mini .article_snippet_mini_info_block, .bet_wrap .bnt_media_preview, .ts_search_sep, .poster__open-btn-wrapper, .deep_active .replies .reply_fakebox, .deep_active.wall_module .replies .reply_fakebox, .deep_active.wall_module .wl_replies_block_wrap .reply_fakebox, .deep_active .wl_replies_block_wrap .reply_fakebox, .deep_active .replies .replies_wrap_deep, .deep_active .post_replies_count, .deep_active.wall_module .post_replies_count, .deep_active.wall_module .wl_replies_block_wrap .replies_wrap_deep, .deep_active .wl_replies_block_wrap .replies_wrap_deep, .bt_reporter_row, .bt_report_footer, .bt_report_one_comments, .bt_report_one_info, .bt_report_one_author, .bt_report_row, .bt_report_one_comments .bt_report_cmt, .feedback_row_clickable:not(.feedback_row_touched):hover, .bt_comment_form_actions, #apps_layer .apps_header, .apps_install_header, .apps_i_policy, #apps_addr_table, .wk_hider_box, .wk_hider_box_opened, .pages_header_info, .pages_history_header_wrap, .pages_history_row, .deep_active .post_replies_header, .groups_edit_event_log_page .groups_edit_event_log_controls, .groups_edit_event_log_page .groups_edit_event_log_items_wrap, .groups_edit_event_log_page .groups_edit_event_log_items_wrap .groups_edit_event_log_item_wrap, .groups_edit_event_log_page .groups_edit_event_log_items_wrap .groups_edit_event_log_item, .ChatSettingsMembersWidget--search .ChatSettingsMembersWidget__header, .thumbed_link--chat-invitation, .mail_link, .audio_pl_snippet2 .audio_pl_snippet__header, .post_actions_btns, .deep_active .replies .replies_wrap_deep .reply_media_preview, .deep_active.wall_module .wl_replies_block_wrap .replies_wrap_deep .reply_media_preview, .deep_active .wl_replies_block_wrap .replies_wrap_deep .reply_media_preview, .deep_active.wl_post.wall_module .wl_replies_block_wrap .wl_replies_empty, .deep_active.wl_post .wl_replies_block_wrap .wl_replies_empty, .im-to-end__button, .app_edit_api_counter_wrap, #app_edit_api_bottom_graphs_wrap, .app_edit_api_duration_graph, .im-page .im-page--error, .im_stickers_my_row~.im_stickers_my_row, .sticker_hints_tt, .sticker_hints_arrow, .im-money-request-snippet, body.dev .paginated_table_row, .friends_list_bl, .bt_report_one_comments .BugreportComment+.BugreportComment, #groups_menu_items .groups_edit_menu_items .groups_edit_menu_item .groups_edit_menu_item_settings, .im-navigation__button, .audio_layer_container .audio_page_player_wrap, .audio_layer_container .audio_page__footer, .im-expired-message--in, .Modal__header--blue, .Modal__footer, .PeerProfileTagsModalField__input, .Select--opened .Select__control, .Select__menu, .CatalogSection__leftColumn, [dir] .thumbed_link--invitation, [dir] body.new_header_design .ts_cont_wrap, [dir] .RightMenuBlock, [dir] .media_link__label, [dir] .BotCarousel__slide, [dir] .market_item_content_bottom, [dir] .cal_clear, [dir] .cal_table>thead, [dir] .cal_table>tbody, [dir] .DonutLinkSnippet, [dir] .group_page_block_footer, [dir] .feed_new_posts, [dir] .box_title_wrap, .FCWindow__header, .FCWindow__footer, [dir] .PageActionCellSeparator, .SettingsListItem + .SettingsListItem, [dir] .im-page .im-page--dialogs-archive-notice-w, [dir] .ui_search_new .ui_search_input_inner, [dir] #stat_group_weekly_reports_table tr.paginated_table_row, [dir] .wpost_post, [dir] .WeekStatBlock--withSeparator:not(:last-of-type), [dir] .feedback_row_wrap {border-color: %slightly_gray_hovered%;}
.ui_actions_menu, .page_actions_wrap, .page_actions_header, .ms_items_more, .tt_default, .tt_default_right, .im-page_classic .im-page--chat-header, .im-page_classic.im-page .im-page--chat-input, .im-page_classic.im-page .im-page--chat-body-wrap-inner, .im-page_classic.im-page .im-page--header, .emoji_tt_wrap, .selector_focused table.selector_table, .wdd_list, .online:after, #top_profile_menu, .replies_side, div.fc_tab_txt, div.fc_clist_filter_wrap, .privacy_dropdown .header, .privacy_dropdown, .idd_popup, .wcomments_form, .Dropdown__in, .im-page .im-page--top-date-bar_visible .im-page--history-new-bar_days.im-page--date-bar-transition>span, .tickets_block_link, .feedback_photo_icon, .ChatSettingsInfo__photoRemove, [dir] .TopNavBtn .TopNavBtn__notifyCount {border-color: %very_gray%;}
#top_notify_wrap, .photos_container .photos_row, .fc_tab_head, .fc_tab, .fc_tab_notify, #fc_ctabs_cont {border-color: %slightly_gray%;}
.group_friends_image, .Tabs__item--active, .Tabs__item--active:hover {border-color: %slightly_gray_hovered%;}
.fc_msgs, .fc_msgs_out .fc_msgs, .group_tokens_row:last-child, .like_cont, .market_item_footer_wrap, [dir] #page_header_cont .back, [dir] #page_header_cont, [dir] .StickerPackPreview__footer, [dir] .ModalFooter, [dir] .ModalHeader--blue, [dir] .gift_tt_show_all {border: none!important;}
.ads_edit_link_type_card.selected {border-color: %pure_white%;}
.media_voting {border: 1px black solid}
.im-audio-message-input.im-chat-input_classic {box-shadow: 0 1px 0 0 rgba(71,71,71,1), 0 0 0 1px rgba(71,71,71,1)!important}
/* == UI TRICKS == */
.image_cover, .photos_choose_row, #top_notify_wrap, .photos_container .photos_row {border-radius: 5px;}
.im_sticker_row {filter:drop-shadow(1px 0 0 #eee) drop-shadow(-1px 0 0 #eee) drop-shadow(0 1px 0 #eee) drop-shadow(0 -1px 0 #eee); padding:1px;}
.emoji_sticker_image {filter:drop-shadow(0.3px 0 0 #eee) drop-shadow(-0.3px 0 0 #eee) drop-shadow(0 0.3px 0 #eee) drop-shadow(0 -0.3px 0 #eee); padding:0.3px;}
.blocked_image, .groups_blocked_spamfight_img {filter: invert(0.861);}
.media_link__label, .media_link__media {border-radius: 0}
.page_block._audio_page_content_block:before, .audio_page_layout .audio_block:before, [dir] .faq_search_form, [dir] .page_block, [dir] #dev_left_nav, [dir] .dev_section_methods_wrap, [dir] #dev_page_wrap1, [dir] .dev_page_block, [dir=ltr] .im-page_classic.im-page .im-page--dialogs-footer, [dir] .im-page_classic.im-page .im-page--chat-body-abs, [dir] .im-chat-input.im-chat-input_classic, [dir] .im-page_classic .im-page--chat-header-in, [dir] .im-page.im-page_classic.im-page_group .im-group-online .im-group-online--inner, [dir] .Button--mobile, [dir] .im-create.im-create_classic .im-create--table, [dir] .apps_footer, [dir] .im-page_classic.im-page .im-page--dialogs-search, [dir] .im-page_classic.im-page .im-page--history_loading, [dir] .List--border, [dir] .ChatSettingsInfo, [dir] .ChatSettingsMembersWidget, [dir] .post--withPostBottomAction.post--withActionStatusBar .wall_post_cont .wall_signed:last-child {box-shadow: none}
.im-page .im-page--history_empty.im-page--history .im-page--center-empty, .im-page .im-page--history_empty.im-page--history .im-page--top-notice, .pv_cont .pv_closed_commments_placeholder, img[src^="/images/camera_"], img[src^="/images/deactivated_"], img[src^="/images/community_"] { filter: grayscale(1) invert(0.862); }
#top_notify_btn .top_nav_btn_icon {filter: %bell_sepia%}
[dir=ltr] .im-page--back-btn:hover {background: url(data:image/svg+xml;charset=utf-8,%3Csvg%20height%3D%2216%22%20viewBox%3D%220%200%209%2016%22%20width%3D%229%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22m8%2015.9c-.2%200-.4-.1-.6-.3l-7-7c-.3-.3-.3-.9%200-1.2l7-7c.3-.3.9-.3%201.2%200s.3.9%200%201.2l-6.4%206.4%206.4%206.4c.3.3.3.9%200%201.2-.2.2-.4.3-.6.3z%22%20fill%3D%22%23828a99%22%20opacity%3D%22.7%22%2F%3E%3C%2Fsvg%3E) 15px 16px no-repeat,linear-gradient(to right,#222 50%,rgba(0,0,0,.1))}
[dir] body.new_header_design .p_head_l0 .top_home_link .top_home_logo { filter: sepia(1) invert(1); }
body { --page-block-shadow: none!important; }
/* == SCREW DEFAULT API IMAGE == */
[dir=ltr] .wall_post_source_icon {background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAMAAACecocUAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABU1BMVEUAAAD///8REREZGRkAAAAEBAQEBAQAAAAZGRkREREjIyMAAAALCwsPDg0OBQMPDg0LCwsAAAAjIyMUFBRTUVHQsKrQsKpTUVEUFBQFBQXj4eHt8PD/5N3/VjP/5N7t8PDj4eEFBQUAAACenp5hcnZhcnaenp4AAAAAAABdX2AHl7gHl7hdX2AAAAAAAABDQkIraXgyPkEyPkEraXhDQkIAAAAVFRXHvbuopqWfoKCopqXHvbsVFRUAAAC8vr9wcHFwcXG9v78AAAAAAAAEBATZ2dnf39/Z2dkEBAQAAAAAAAAAAAABAQEqKioqKioBAQEAAAAAAABGRkZGRkZCQkKyurzEIgKyurxCQkJxcXFxcXGIiIh6fH11Y2B6fH2IiIh1dHQHJSwAAAAHJi11dHR4eHgsJiR4eHiQkJCQkJBDQ0NKSUlCQkJubm5ubm5DQ0P///8TfFsbAAAAUnRSTlMAAMb6LwICL/rG75yLoJygi5zvtPv///u0svr7+/v7+/qytP3///20m/z///ybH+z+///+7CDN/f////3NfPn+/vl8B779//2+BwELi+vriwsBriooAgAAAAFiS0dEAf8CLd4AAAAHdElNRQfhDBYUKBWK4cYoAAAAhUlEQVQI1wXBQwICAAAEwM22bdu2bduu/9+aAZFEBgVU0OgMMIcsNofL4wtGQojG4olkKp3J5nIoFkqVWqPV6ZcGGFcm83qztVh3Ntj3DufheHK5zx54fRd/4BoM3cIREKL3WDyRTD3SBCDzzOZe+cK7CKBU/lSqtW+9ATTRand+3V4fgz8s+hhKWwGqOQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNy0xMi0yMlQyMDo0MDoyMS0wNTowMAmNQVUAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTctMTItMjJUMjA6NDA6MjEtMDU6MDB40PnpAAAAAElFTkSuQmCC');}
a.im-mess-stack--lnk[href="/notqb"]::after{  content: '12345'; color: #1111; margin-left: 5px; margin-right: -22.5px; background: url("data:image/svg+xml;charset=utf-8,%3Csvg%20viewBox%3D%220%200%2012%2012%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22m2.25%206.75%202.25%202.25%205.25-5.25%22%20fill%3D%22none%22%20stroke%3D%22%235c9ce6%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%222%22%2F%3E%3C%2Fsvg%3E") no-repeat 0;
}
`;
for (var key in themes[theme])
    css.innerText = css.innerText.replaceAll('%'+key+'%',  themes[theme][key]+'!important');

if (localStorage.getItem('VKDarkMode') === null)
    localStorage.setItem('VKDarkMode', false);
var darkmodeEnabled = localStorage.getItem('VKDarkMode') == 'true';

var ptp = document.querySelector('#top_nav > li.HeaderNav__item.HeaderNav__btns');
var div = document.createElement('div');
div.innerHTML = `<a id="top_nightmode" class="TopNavBtn" onmousedown="toggleNightMode()" onclick="return checkEvent(event);" aria-label="Ночной режим" aria-haspopup="false" accesskey="4">
    <span class="blind_label">Ночной режим</span>
    <div class="TopNavBtn__icon"><svg width="26" height="26" viewBox="0 2 28 28" style="fill: `+themes[theme]['slighterer_gray_hovered']+`;pointer-events: none;display: block;width: 100%;height: 100%;"><g>
        <path d="M24.166185 15.685249C 24.958563 15.404641 25.722574 16.167528 25.443132 16.96032C 24.874369 18.573923 23.997759 20.00623 22.811165 21.18858C 18.393013 25.606783 11.231925 25.606094 6.8144674 21.188791C 2.3952134 16.772114 2.3952134 9.609282 6.8142524 5.1905975C 7.9987087 4.006112 9.431381 3.1288698 11.041682 2.5592253C 11.834589 2.2787347 12.598512 3.0428054 12.317867 3.8356571C 11.124091 7.2082057 11.924086 10.969348 14.478231 13.525238C 17.032188 16.078697 20.795307 16.878992 24.166185 15.685249zM13.063986 14.93942C 10.487862 12.361646 9.379176 8.7769985 9.901207 5.2957897C 9.291474 5.6652746 8.7316265 6.101638 8.228446 6.6048307C 4.5905538 10.242431 4.5905538 16.13857 8.228462 19.774359C 11.865127 23.410896 17.759897 23.411463 21.398214 19.773106C 21.902489 19.270634 22.339043 18.711378 22.7083 18.101625C 19.226978 18.624207 15.640337 17.515377 13.063986 14.93942z" fill="currentColor"</path>
      </g></svg></div>
</a>
<a id="top_vknsettings" class="TopNavBtn" onmousedown="showVKNSettings()" onclick="return checkEvent(event);" aria-label="VKN Настройки" aria-haspopup="false" accesskey="5">
    <span class="blind_label">VKN Настройки</span>
    <div class="TopNavBtn__icon"><svg width="26" height="26" viewBox="0 2 28 28" preserveAspectRatio="xMidYMid meet" focusable="false" style="fill: `+themes[theme]['slighterer_gray_hovered']+`;pointer-events: none;display: block;width: 100%;height: 100%;"><g>
        <path d="M15.1480123,2.04074374 C15.5755544,2.10915048 15.9799903,2.27274253 16.3431401,2.56326238 C16.9380313,3.03917538 17.2213264,3.6390943 17.440285,4.51492875 C17.4963389,4.73914434 17.593329,5.00052458 17.7145515,5.25420891 C17.9926195,5.37242817 18.2646756,5.50383096 18.5298601,5.64789715 C18.7916136,5.58322866 19.0429929,5.49734188 19.2437275,5.40389237 C20.6559711,4.74643965 21.840713,4.78098291 22.810912,5.82743499 C22.8929739,5.9159466 22.941971,5.97458142 23.0485755,6.10622704 L23.6778959,6.883373 C23.8471459,7.09237932 23.9194483,7.18760885 24.0262155,7.36529764 C24.7180725,8.51673099 24.4482992,9.58908522 23.5738105,10.7510996 C23.4287142,10.9439025 23.2805641,11.1963043 23.1566296,11.4618362 C23.234813,11.7443748 23.2999255,12.0308759 23.3516777,12.3205887 C23.5744346,12.499037 23.8112044,12.6554046 24.020328,12.7621251 C24.8244599,13.1724917 25.3452754,13.5834783 25.6751694,14.2701797 C25.8765523,14.6893747 25.9449732,15.1202452 25.9154506,15.5522176 C25.8998459,15.7805458 25.8751715,15.9078085 25.8093791,16.1927867 L25.584428,17.1671567 C25.5186356,17.4521349 25.4850245,17.5773344 25.3989575,17.7893951 C25.236128,18.1905912 24.9857505,18.5478612 24.6209857,18.8363508 C24.0234489,19.3089379 23.3751784,19.4500197 22.4725365,19.4663465 C22.2442027,19.4704766 21.9713526,19.5054091 21.6999312,19.5651972 C21.523462,19.809022 21.3355319,20.0443479 21.1368338,20.2703621 C21.1402402,20.5445584 21.1674942,20.8140308 21.21419,21.0344025 C21.4013318,21.9175824 21.4096951,22.5809743 21.0836369,23.2695052 C20.8845955,23.6898172 20.592805,24.0141458 20.2385202,24.2630515 C20.0512554,24.3946159 19.9368256,24.4555293 19.6739515,24.5837416 L18.7751575,25.0221127 C18.5122834,25.150325 18.3938329,25.2029948 18.174867,25.2695623 C17.7606072,25.3955009 17.3253886,25.4257584 16.8716362,25.3238353 C16.1283249,25.1568707 15.6107139,24.7418555 15.0299746,24.0506458 C14.8764629,23.8679325 14.666696,23.6690715 14.4386231,23.4900155 C14.2928169,23.4966652 14.1465814,23.5 14,23.5 C13.8534186,23.5 13.7071831,23.4966652 13.5613769,23.4900155 C13.333304,23.6690715 13.1235371,23.8679325 12.9700254,24.0506458 C12.3892861,24.7418555 11.8716751,25.1568707 11.1283638,25.3238353 C10.6746114,25.4257584 10.2393928,25.3955009 9.82513296,25.2695623 C9.60616706,25.2029948 9.48771663,25.150325 9.22484252,25.0221127 L8.32604848,24.5837416 C8.24702677,24.5452709 8.19801021,24.5209844 8.14075277,24.4911677 C6.8292028,23.8081792 6.44471312,22.6441436 6.78581002,21.0344025 C6.83250579,20.8140308 6.85975979,20.5445584 6.86316617,20.2703621 C6.66446808,20.0443479 6.47653801,19.809022 6.30006883,19.5651972 C6.02864736,19.5054091 5.75579729,19.4704766 5.52746347,19.4663465 C4.62482163,19.4500197 3.97655107,19.3089379 3.37901428,18.8363508 C3.0142495,18.5478612 2.76387202,18.1905912 2.60104249,17.7893951 C2.51497546,17.5773344 2.48136436,17.4521349 2.41557197,17.1671567 L2.19062092,16.1927867 C2.12096477,15.8910728 2.09530369,15.7565206 2.08209042,15.5120465 C2.05732004,15.053741 2.14502416,14.5984123 2.3776563,14.1664301 C2.71660439,13.5370263 3.21830349,13.1506686 3.97967199,12.7621251 C4.18879563,12.6554046 4.42556542,12.499037 4.64832231,12.3205887 C4.70007448,12.0308759 4.76518695,11.7443748 4.84337042,11.4618362 C4.71943592,11.1963043 4.5712858,10.9439025 4.42618951,10.7510996 C3.5517008,9.58908522 3.28192751,8.51673099 3.97378453,7.36529764 C4.08055167,7.18760885 4.15285412,7.09237932 4.3221041,6.883373 L4.95142449,6.10622704 C5.05802901,5.97458142 5.10702613,5.9159466 5.18908804,5.82743499 C6.15928699,4.78098291 7.34402894,4.74643965 8.75627252,5.40389237 C8.95700705,5.49734188 9.20838638,5.58322866 9.47013989,5.64789715 C9.73532438,5.50383096 10.0073805,5.37242817 10.2854485,5.25420891 C10.406671,5.00052458 10.5036611,4.73914434 10.559715,4.51492875 C10.7786736,3.6390943 11.0619687,3.03917538 11.6568599,2.56326238 C12.0200097,2.27274253 12.4244456,2.10915048 12.8519877,2.04074374 C13.032777,2.01181746 13.1518478,2.00309724 13.3419913,2.0007662 L14.5,2 C14.7924742,2 14.9220257,2.00458589 15.1480123,2.04074374 Z M14.585691,4.00020354 L13.5,4 C13,4 12.75,4 12.5,5 C12.3612322,5.55507136 12.0684122,6.26419483 11.6642951,6.87084066 C11.0217099,7.08123793 10.4173658,7.37609281 9.86438385,7.74228441 C9.14762015,7.67166339 8.42429968,7.45545202 7.91218277,7.21704225 C6.97770671,6.78200835 6.82037661,6.97629484 6.50571641,7.36486782 L5.87639602,8.14201378 C5.56173583,8.53058676 5.40440573,8.72487325 6.02422159,9.54848014 C6.37307911,10.0120395 6.74535143,10.6983758 6.9612408,11.4045337 C6.74017617,12.0038451 6.59346671,12.6391528 6.53230345,13.2992655 C6.03068735,13.8335281 5.40134246,14.2819913 4.88878006,14.5435634 C3.97064776,15.012107 4.02688552,15.2556995 4.13936105,15.7428845 L4.3643121,16.7172546 C4.47678763,17.2044396 4.53302539,17.4480322 5.56363322,17.4666736 C6.13345667,17.4769805 6.88659564,17.6018356 7.56651129,17.8570989 C7.9118453,18.4318656 8.33202244,18.9565458 8.81356234,19.4176592 C8.90791525,20.1351985 8.86006774,20.8935264 8.74236787,21.4489883 C8.52869524,22.4573751 8.75339375,22.5669679 9.20279077,22.7861535 L10.1015848,23.2245246 C10.5509818,23.4437102 10.7756804,23.553303 11.43875,22.7641017 C11.8105483,22.3215785 12.3925558,21.8066745 13.0292334,21.4377508 C13.3470161,21.4788205 13.6710347,21.5 14,21.5 C14.3289653,21.5 14.6529839,21.4788205 14.9707666,21.4377508 C15.6074442,21.8066745 16.1894517,22.3215785 16.56125,22.7641017 C17.2243196,23.553303 17.4490182,23.4437102 17.8984152,23.2245246 L18.7972092,22.7861535 C19.2466063,22.5669679 19.4713048,22.4573751 19.2576321,21.4489883 C19.1399323,20.8935264 19.0920847,20.1351985 19.1864377,19.4176592 C19.6679776,18.9565458 20.0881547,18.4318656 20.4334887,17.8570989 C21.1134044,17.6018356 21.8665433,17.4769805 22.4363668,17.4666736 C23.4669746,17.4480322 23.5232124,17.2044396 23.6356879,16.7172546 L23.860639,15.7428845 C23.9731145,15.2556995 24.0293522,15.012107 23.1112199,14.5435634 C22.5986575,14.2819913 21.9693127,13.8335281 21.4676965,13.2992655 C21.4065333,12.6391528 21.2598238,12.0038451 21.0387592,11.4045337 C21.2546486,10.6983758 21.6269209,10.0120395 21.9757784,9.54848014 C22.5955943,8.72487325 22.4382642,8.53058676 22.123604,8.14201378 L21.4942836,7.36486782 C21.1796234,6.97629484 21.0222933,6.78200835 20.0878172,7.21704225 C19.5757003,7.45545202 18.8523799,7.67166339 18.1356162,7.74228441 C17.5826342,7.37609281 16.9782901,7.08123793 16.3357049,6.87084066 C15.9315878,6.26419483 15.6387678,5.55507136 15.5,5 C15.2647059,4.05882353 15.0294118,4.00346021 14.585691,4.00020354 Z M14,9.5 C16.4852814,9.5 18.5,11.5147186 18.5,14 C18.5,16.4852814 16.4852814,18.5 14,18.5 C11.5147186,18.5 9.5,16.4852814 9.5,14 C9.5,11.5147186 11.5147186,9.5 14,9.5 Z M14,11.5 C12.6192881,11.5 11.5,12.6192881 11.5,14 C11.5,15.3807119 12.6192881,16.5 14,16.5 C15.3807119,16.5 16.5,15.3807119 16.5,14 C16.5,12.6192881 15.3807119,11.5 14,11.5 Z" fill="currentColor"</path>
      </g></svg></div>
</a>`;
setTimeout(function(){
    var v = document.querySelector('#top_nav > li.HeaderNav__item.HeaderNav__btns');
    if (!v)
        return;
    v.appendChild(div.firstChild);
    div.firstChild.remove();
    v.appendChild(div.firstChild);
}, 5000);

var appended = false;

if (darkmodeEnabled == true) {
    let head = document.head || document.getElementsByTagName("head")[0];
    head.appendChild(css);
    appended = true;
    interval = setInterval(function(){
        if (head.lastChild.id != socalled)
            swapElements(css, head.lastChild);
    }, 250);
}
function swapElements(obj1, obj2) {
    if (obj1.id == obj2.id)
        return;
    var temp = document.createElement("div");
    obj1.parentNode.insertBefore(temp, obj1);
    obj2.parentNode.insertBefore(obj1, obj2);
    temp.parentNode.insertBefore(obj2, temp);
    temp.parentNode.removeChild(temp);
}

unsafeWindow.toggleNightMode = function(){
    darkmodeEnabled = !darkmodeEnabled;
    localStorage.setItem('VKDarkMode', darkmodeEnabled);
    let head = document.head || document.getElementsByTagName("head")[0];
    if (darkmodeEnabled) {
        if (!appended)
            head.appendChild(css);
        interval = setInterval(function(){
            if (head.lastChild.id != socalled)
                swapElements(css, head.lastChild);
        }, 250);
    } else {
        if (interval >= 0)
            clearInterval(interval);
        appended = false;
        head.removeChild(css);
    }
};

unsafeWindow.showVKNSettings = function(){
    if (document.getElementById('vknsettings'))
        return;
    showFastBox('Настройки', `<div class="box_body" style="display: block; padding: 0px;">
        <div style="padding: 10px 25px;">
            <h4 class="subheader">Управление отправкой данных</h4>
            <div style="padding: 5px;">
                <div class="checkbox{a1}" onclick="checkbox(this); VKNOptionSet('noonline', isChecked(this));" role="checkbox" aria-checked="{v1}" tabindex="0">
                    Не отправлять данные об онлайне
                </div>
            </div>
            <div style="padding: 5px;">
                <div class="checkbox{a2}" onclick="checkbox(this); VKNOptionSet('silentwrite', isChecked(this));" role="checkbox" aria-checked="{v2}" tabindex="0">
                    Не показывать, что вы пишите сообщение
                </div>
            </div>
            <div style="padding: 5px;">
                <div class="checkbox{a3}" onclick="checkbox(this); VKNOptionSet('silentread', isChecked(this));" role="checkbox" aria-checked="{v3}" tabindex="0">
                    Не помечать сообщения прочитанными
                </div>
            </div>
            <div style="padding: 5px;">
                <div class="checkbox{a4}" onclick="checkbox(this); VKNOptionSet('silentwatch', isChecked(this));" role="checkbox" aria-checked="{v4}" tabindex="0">
                    Не показывать, что вы просмотрели видео
                </div>
            </div>
            <div style="padding: 5px;">
                <div class="checkbox{a5}" onclick="checkbox(this); VKNOptionSet('nodeleteall', isChecked(this));" role="checkbox" aria-checked="{v5}" tabindex="0">
                    Оставлять удаленные навсегда сообщения
                </div>
            </div>
        </div>
    </div>`
                .replace('{a1}', VKNOptionGet('noonline') ? ' on' : '').replace('{a2}', VKNOptionGet('silentwrite') ? ' on' : '').replace('{a3}', VKNOptionGet('silentread') ? ' on' : '').replace('{a4}', VKNOptionGet('silentwatch') ? ' on' : '').replace('{a5}', VKNOptionGet('nodeleteall') ? ' on' : '')
                .replace('{v1}', VKNOptionGet('noonline').toString()).replace('{v2}', VKNOptionGet('silentwrite').toString()).replace('{v3}', VKNOptionGet('silentread').toString()).replace('{v4}', VKNOptionGet('silentwatch').toString()).replace('{v5}', VKNOptionGet('nodeleteall').toString()));
};

unsafeWindow.closeVKNSettings = function(){
    document.getElementById('box_layer').parentNode.style.display = '';
    document.getElementById('vknsettings').remove();
};

unsafeWindow.VKNOptionSet = function(name, value){
    vknopts[name] = value;
    GM_setValue("VKNOptions", vknopts);
};

function VKNOptionGet(name){
    return vknopts[name];
}

XMLHttpRequest.prototype.realXMLRequestSend = XMLHttpRequest.prototype.send;
XMLHttpRequest.prototype.send = function(vData) {
    if (vData && typeof(vData) == 'string'){
        if (
            (vData.includes('a_mark_read') && VKNOptionGet('silentread')) || // Read
            ((vData.includes('a_activity') || vData.includes('a_block_release')) && !vData.includes('a_activity_history_box') && VKNOptionGet('silentwrite')) || // Write
            (vData.includes('a_online') && VKNOptionGet('noonline')) || // Online
            ((vData.includes('event=load') || vData.includes('videocat') || vData.includes('track_player_events') || vData.includes('seek_durations') || vData.includes('inc_view_counter')) && VKNOptionGet('silentwatch')) // Video
        ){
            this.onreadystatechange = function(){};
            this.abort();
            return;
        }
        if (vData.includes('a_start') && vData.includes('block')) // Silent community message reading
            vData = vData.replace('block=true', 'block=false');
    }
    // Этот костыль запрещает удалять сообщения
    if (VKNOptionGet('nodeleteall') && !this.onprogress) this.onprogress = () => {
        try{
            var json = JSON.parse(this.responseText), edited = false;
            if (json.ts && json.updates){
                for (var update of json.updates) {
                    if (update[0] == 2 && update[2] == 131200) {
                        let msg = document.querySelector('[data-msgid="'+update[1]+'"]');
                        if (msg && msg.querySelector('._im_log_body'))
                            msg.querySelector('._im_log_body').innerHTML += ' <span class="im-mess--lbl-was-edited _im_edit_time" data-time="'+Math.round(+new Date()/1000)+'">(удалено)</span>';
                        update[2] = 1;
                        edited = true;
                    }
                }
                if (edited) {
                    Object.defineProperty(this, 'responseText', {
                        writable: true
                    });
                    this.responseText = JSON.stringify(json);
                }
            }
        } catch(e){}
    };
    this.realXMLRequestSend(vData);
};
